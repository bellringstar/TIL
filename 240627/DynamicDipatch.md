# 동적 디스패치(Dynamic Dispatch)
동적 디스패치는 객체 지향 프로그래밍에서 중요한 개념으로, 런타임에 메서드 호출이 결정되는 방식을 의미합니다. 이는 다형성을 
구현하는 핵심 메커니즘 중 하나로 객체의 실제 타입에 따라 호출할 메서드를 동적으로 선택합니다.

## 동적 디스패치의 원리
1. 다형성
- 객체 지향 언어에서 다형성은 같은 인터페이스나 상위 클래스의 메서드가 여러 서브클래스에서 다양한 방식으로 구현되는 것을 의미합니다.
- 다형성을 통해 같은 메서드 호출이 다른 클래스의 인스턴스에서 다르게 동작할 수 있습니다.
2. 메서드 오버라이딩
- 서브클래스가 상위 클래스의 메서드를 재저으이하는 것을 의미합니다. 이를 통해 서브클래스는 상위 클래스의 메서드를 자신의 방식으로 구현할 수 있습니다.
- 동적 디스패치는 메서드 오버라이딩된 메서드를 런타임에 호출할 때 발생합니다.
3. 런타임 결정
- 컴파일 시점이 아닌 런타임에 객체의 실제 타입을 기반으로 메서드 호출을 결정합니다. 이는 상위 클래스 타입의 변수로 서브클래스 객체를 참조할 때 유용합니다.

## 동적 디스패치의 이점
1. 유연성
- 코드의 유연성을 높여줍니다. 같은 타입의 변수를 사용해 다양한 객체를 다룰 수 있으며, 객체의 실제 타입에 따라 다르게 동작할 수 있습니다.
2. 확장성
- 시스템을 쉽게 확장할 수 있습니다. 새로운 서브클래스를 추가하고 메서드를 오버라이드하면, 기존 코드를 수정하지 않고도 새로운 동작을 추가할 수 있습니다.
3. 코드 재사용성
- 공통된 인터페이스나 상위 클래스를 통해 코드의 재사용성을 높여줍니다. 공통된 로직을 상위 클래스에 작성하고, 서브클래스에서 필요한 부분만 재정의할 수 있습니다.

## 동적 디스패치의 내부 동작
1. 가상 메서드 테이블(Virtual Method Table, vtable)
- 자바는 가상 메서드 테이블을 사용하여 동적 디스패치를 구현합니다. vtable은 각 클래스마다 생성되며, 해당 클래스의 메서드 주소를 저장하는 배열입니다.
- 객체의 객체의 실제 타입에 따라 vtable을 참조하여 적절한 메서드를 호출합니다.
2. 메서드 호출 과정
- 객체의 실제 타입을 확인합니다.
- 실제 타입의 vtable을 참조하여 호출할 메서드의 주소를 가져옵니다.
- 해당 주소로 메서드를 호출합니다.

## 가상 메서드 테이블
### 기본 개념
1. 가상 메서드
- 객체 지향 언어에서 메서드 오버라이딩이 가능한 메서드를 가상 메서드라고 합니다.
- C++에서는 virtual 키워드를 사용해 명시적으로 선언하지만 자바와 같은 언어에서는 모든 메서드가 기본적으로 가상 메서드입니다.
2. vtable의 정의
- vtable은 각 클래스마다 하나씩 존재하는 테이블로, 해당 클래스의 가상 메서드에 대한 포인터(주소)를 저장하는 배열입니다.
- 각 객체는 자신의 클래스에 해당하는 vtable을 참조합니다.
### 동작 원리
1. 클래스와 vtable
- 각 클래스는 자신의 vtable을 가지고 있습니다. vtable에는 클래스의 가상 메서드의 주소가 저장됩니다.
- 예를 들어 클래스 Animal이 있고 이를 상속받는 Dog 클래스가 있다고 합시다. Dog 클래스는 Animal 클래스의 메서드를 오버라이드할 수 있습니다.
2. 객체 생성
- 객체가 생성되면 해당 객체는 클래스의 vtable을 참조합니다.
- 예를 들어 Dog 객체가 생성되면 이 객체는 Dog 클래스의 vtable을 참조하게 됩니다.
3. 메서드 호출
- 메서드 호출 시 객체의 실제 타입에 해당하는 vtable에서 메서드의 주소를 찾아 호출합니다.
- 이를 통해 컴파일 시점이 아닌 런타임에 실제 메서드가 결정되고 호출됩니다.
### 동작 예시
Animal 클래스에 sound() 메서드가 있고 이를 상속받은 Dog 클래스에서 sound() 메서드를 오버라이드 한 상황
1. 클래스 생성
- Animal animal = new Animal() => Animal 클래스의 vtable에는 sound() 메서드의 주소가 저장됩니다.
- Animal dog = new Dog(); => Dog 클래스는 Animal 클래스를 상속받으므로 Dog 클래스의 vtable에도 sound() 메서드의 주소가 저장되어있지만 이는 Dog 클래스의 sound()메서드를 가리킵니다.
2. 객체 생성
- Animal animal = new Animal() 이 코드로 Animal 객체를 생성하면 이 객체는 Animal 클래스의 vtable을 참조합니다.
- Animal dog = new Dog() 이 코드로 Dog 객체를 생성하면 이 객체는 Dog 클래스의 vtable을 참조합니다.
3. 메서드 호출
- animal.sound()를 호출하면 animal 객체는 Animal 클래스의 vtable을 참조하여 Animal 클래스의 sound() 메서드를 호출합니다.
- dog.sound()를 호출하면 dog 객체는 dog 클래스의 vtable을 참조하여 Dog 클래스의 sound() 메서드를 호출합니다.