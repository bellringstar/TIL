# 가상 메모리
> 가상 메모리는 마치 도서관의 책 관리 시스템과 비슷합니다. 도서관에는 제한된 수의 책장(물리적 매모리)이 있지만, 소장하고 있는 책의 수(프로그램과 데이터)는 훨씬 많습니다.
> 모든 책을 항상 책장에 꽂아둘 수는 없겠죠. 대신, 도서관은 모든 책의 목록(페이지 테이블)을 가지고 있고, 필요할 때마다 책을 창고(하드 디스크)에서 가져와 책장에 놓습니다. 이것이 바로 가상 메모리의 기본 개념입니다.

## 기본 개념 이해
### 물리적 메모리 vs 가상 메모리
#### 물리적 메모리
- 실제 컴퓨터의 RAM(Random Access Memory)을 의미합니다.
- 유한하며, 일반적으로 수 GB에서 수백 GB 정도의 크기를 가집니다.
- CPU가 직접 접근할 수 있는 메모리입니다.

#### 가상 메모리
- 각 프로세스에 제공되는 추상화된 메모리 공간입니다.
- 물리적 메모리보다 훨씬 큰 주소 공간을 제공할 수 있습니다.(32비트 시스템에서는 최대 4GB, 64비트 시스템에서는 이론적으로 18.4 엑사바이트)
- 프로세스는 자신만의 연속적인 메모리 공간을 가지고 있는 것처럼 동작할 수 있습니다.
### Paging 시스템
페이징은 가상 메모리를 구현하는 가장 일반적인 방법입니다.
- 가상 메모리와 물리적 메모리를 동일한 크기의 블록으로 나눕니다. 이 블록을 '페이지'라고 부릅니다.
- 일반적으로 페이지 크기는 4KB이지만, 시스템에 따라 다를 수 있습니다.
- 가상 주소 공간의 페이지를 '가상 페이지', 물리적 메모리의 페이지를 '물리적 페이지' 또는 '프레임'이라고 부릅니다.

#### 페이징의 주요 이점
- 메모리 단편화 감소: 고정 크기의 페이지를 사용함으로써 메모리 할당과 해제가 더 효율적으로 이루어집니다.
- 메모리 보호: 각 프로세스는 자신의 가상 주소 공간만 접근할 수 있어, 다른 프로세스의 메모리를 침범할 수 없습니다.
- 공유 메모리 구현 용이: 여러 프로세스가 같은 물리적 페이지를 공유할 수 있습니다.
### 주소 변환
가상 주소에서 물리적 주소로의 변환은 다음과 같이 이루어집니다.
- 가상 주소는 페이지 번호와 오프셋으로 구성됩니다.
- 페이지 테이블을 사용하여 가상 페이지 번호를 물리적 페이지 번호로 변환합니다.
- 변환된 물리적 페이지 번호에 오프셋을 더해 최종 물리적 주소를 얻습니다.

### 질의응답
1. 가상 메모리가 없다면 어떤 문제가 발생할까요?
- 프로그램의 크기가 물리적 메모리 크기로 제한됩니다.
- 여러 프로그램을 동시에 실행하기 어려워집니다.
- 메모리 보호가 복잡해지고, 프로그램 간 격리가 어려워집니다.
- 메모리 단편화 문제가 심각해질 수 있습니다.
2. 페이지 크기는 어떻게 결정되나요?
- 페이지 크기는 하드웨어와 운영체제에 의해 결정됩니다. 일반적으로 4KB가 많이 사용되지만, 더 큰 크기 (예:2MB, 1GB)도 사용됩니다. 페이지 크기를 결정할 때는 다음 요소를 고려합니다.
- 내부 단편화: 큰 페이지 크기는 내부 단편화를 증가시킬 수 있습니다.
- TLB 효율성: 큰 페이지를 사용하면 TLB 히트율이 증가할 수 있습니다.
- I/O 성능: 큰 페이지는 디스크 I/O 성능을 향상시킬 수 있습니다.
## 페이지 테이블
## 주소 변환
## 페이지 폴트(Page Fault)
## 페이지 교체 알고리즘
## 스레싱(Thrashing)
## 질의응답